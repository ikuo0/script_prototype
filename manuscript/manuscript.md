


# はじめに
本書はスクリプト言語の作り方について解説します。
「スクリプト言語の作り方」は「ソースコードテキストをアセンブラのような実行構造に変換する」ことです、この説明だけで察しがついた方は本書を読む必要は無いと思います。
何を言っているか理解できなかった方は本書を読む価値があると思います

## 前提知識
if文、for文、関数などといった基本的な概念を理解している程度の技術を要します、完全な初心者向けではありません。

## 本書の構成
CUP、メモリの仕組みを簡単に説明し、その後ほとんどの項目で擬似アセンブラの解説をすることになります。
JavaScript で作ったスクリプト言語を題材にして話を進めます。

# CPUの仕組み
## CPUでプログラムを実行するとは？

CPU と 1KB のメモリがあることを想像してください
メモリは巨大な１次元配列で 0x0000～0x03ff のアドレスを指定することでそのメモリのその箇所を読み書きします

メモリには下記のように命令が書き込んであるとします

表１　命令サンプル
|メモリアドレス|書き込んである命令|
|-|-|
|0x0001 |PRINT "Hello"|
|0x0002 |PRINT " World"|
|0x0003 |PRINT "!"|
|0x0004 |END|

`PRINT` はモニタに指定した文字列を出力する命令とする
`END` は処理を終了し、CPUを停止させる命令とする


CPUは以下の動作をする
- CPU に電源を投入し起動すると `プログラムカウンタ（PC）` に 0x0000 が設定されます
- プログラムカウンタ＝メモリアドレス　としてメモリから命令を読み込む
- 読み込んだ命令を実行する
  - 命令が `END` 命令であれば処理を終了しCPUを停止する
- `プログラムカウンタ（PC）` に１を加算する

動作定義に従い「表１　命令サンプル」のメモリ状態でCPUを起動する

0x0001 を読み出したCPUは PRINT "Hello" を実行します、実行
0x0002 を読み出したCPUは PRINT " World" を実行します
0x0003 を読み出したCPUは PRINT "!" を実行します
0x0004 を読み出したCPUは END を実行します

結果として CPU は `Hello World!` と出力して停止します


